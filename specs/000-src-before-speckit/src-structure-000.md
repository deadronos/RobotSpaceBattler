# src Directory Structure

This document outlines the structure of the `src` directory, providing a high-level summary of each file's purpose.

## Root Files

- **`App.tsx`**: The main React component for the application, which sets up the overall layout and providers.
- **`auto-imports.d.ts`**: TypeScript declaration file for automatic imports, likely generated by a build tool.
- **`index.css`**: Global CSS stylesheet for the application.
- **`main.tsx`**: The entry point of the application, where the React application is rendered into the DOM.

## `src/components`

This directory contains React components that are used to build the user interface and the 3D scene.

- **`Beam.tsx`**: A React component for rendering a beam weapon effect in the 3D scene.
- **`DiagnosticsOverlay.tsx`**: A component that displays an overlay with diagnostic information, such as performance metrics.
- **`FXLayer.tsx`**: A component that manages and renders a layer of special effects in the scene.
- **`Projectile.tsx`**: A component for rendering a single projectile in the 3D scene.
- **`ProjectileStreak.tsx`**: A component that creates a visual streak effect for moving projectiles.
- **`Scene.tsx`**: Sets up the `react-three-fiber` canvas and the main 3D scene, including lights and environment.
- **`Simulation.tsx`**: A core component that contains the game simulation logic, including the ECS world and systems.

### `src/components/environment`

This subdirectory contains components related to the 3D environment. (Currently empty)

### `src/components/ui`

This subdirectory contains general-purpose UI components. (Currently empty)

## `src/ecs`

This directory contains the core of the Entity-Component-System (ECS) architecture, powered by `miniplex`.

- **`ecsResolve.ts`**: Contains functions for resolving ECS-related queries or lookups.
- **`entityLookup.ts`**: Provides utilities for looking up and managing entities within the ECS world.
- **`fx.ts`**: Contains functions and systems related to creating and managing special effects within the ECS.
- **`hooks.ts`**: A collection of React hooks for interacting with the ECS world from within components.
- **`miniplexStore.ts`**: The central file for the `miniplex` ECS store, where the world and archetypes are defined.
- **`pauseManager.ts`**: A manager for handling the pausing and resuming of the simulation.
- **`pauseVelocity.ts`**: A utility for managing the velocity of entities when the game is paused.
- **`renderKey.ts`**: A utility for generating unique keys for rendering, which can help with performance optimizations.
- **`weapons.ts`**: Contains ECS-related logic for weapons, such as components and systems.
- **`worldFactory.ts`**: A factory function for creating and initializing the `miniplex` world.

## `src/hooks`

This directory contains custom React hooks used throughout the application.

- **`useEntityPhysicsSync.ts`**: A hook that synchronizes the state of an entity between the ECS and the physics engine.
- **`useFixedStepLoop.ts`**: A hook that provides a fixed-step game loop, essential for deterministic simulations.
- **`useSimulationBootstrap.ts`**: A hook for bootstrapping and setting up the initial state of the simulation.

## `src/robots`

This directory contains files related to the generation and management of robots.

- **`prefabCatalog.ts`**: A catalog of robot prefabs, which are pre-configured entity templates.
- **`robotPrefab.tsx`**: A React component that represents a robot prefab, which can be instantiated in the scene.
- **`spawnControls.ts`**: Contains logic and controls for spawning new robots into the world.
- **`weaponProfiles.ts`**: Defines the profiles and characteristics of different weapons that robots can use.

## `src/store`

This directory contains state management stores, using `zustand`.

- **`scoreStore.ts`**: A `zustand` store for managing the game score.
- **`uiStore.ts`**: A `zustand` store for managing the state of the user interface.

## `src/systems`

This directory contains the various systems that operate on the entities and components in the ECS world.

- **`AISystem.ts`**: The main system for controlling the behavior of AI-driven robots.
- **`BeamSystem.ts`**: A system that manages the logic for beam weapons.
- **`DamageSystem.ts`**: A system that handles the application of damage to entities.
- **`FxSystem.ts`**: A system for managing and updating special effects.
- **`HitscanSystem.ts`**: A system for handling hitscan weapons, which have instantaneous travel time.
- **`perception.ts`**: Contains functions related to AI perception, such as detecting other entities.
- **`PhysicsSyncSystem.ts`**: A system that synchronizes the state of the physics world with the ECS world.
- **`ProjectileSystem.ts`**: A system that manages the movement and logic of projectiles.
- **`rapierHelpers.ts`**: A collection of helper functions for interacting with the `Rapier` physics engine.
- **`RespawnSystem.ts`**: A system that handles the respawning of entities after they are destroyed.
- **`ScoringSystem.ts`**: A system that manages the game's scoring logic.
- **`WeaponSystem.ts`**: A system that manages the firing and state of weapons.

### `src/systems/ai`

This subdirectory contains more specific AI-related logic. (Currently empty)

## `src/textures`

This directory contains texture files for 3D models.

### `src/textures/metalGrey`

This subdirectory contains textures for a grey metal material. (Currently empty)

## `src/utils`

This directory contains various utility functions and helpers.

- **`fixedStepDriver.ts`**: A driver for the fixed-step game loop, which can be used to control the simulation's timing.
- **`materials.ts`**: A collection of utility functions for creating and managing materials in `three.js`.
- **`sceneMetrics.ts`**: A utility for capturing and reporting metrics about the 3D scene.
- **`seededRng.ts`**: A seeded random number generator, which is crucial for deterministic simulations.
